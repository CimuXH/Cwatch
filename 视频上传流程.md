┌─────────────────────────────────────────────────────────────┐
│ 1. 前端请求上传凭证                                          │
│    POST /api/video/upload-url                               │
│    Body: { filename: "test.mp4", filesize: 102400 }         │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│ 2. 后端处理                                                  │
│    - 验证用户登录状态（JWT）                                  │
│    - 检查文件大小、格式是否合法                               │
│    - 生成唯一文件名（如：uuid + 原文件名）                    │
│    - 调用 MinIO SDK 生成预签名上传URL（有效期如15分钟）       │
│    - 在数据库创建视频记录（状态：上传中）                     │
│    - 返回：{ uploadUrl, videoId }                           │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│ 3. 前端直传到 MinIO                                          │
│    PUT {uploadUrl}                                          │
│    Body: 视频文件二进制数据                                   │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│ 4. 前端通知后端上传完成                                       │
│    POST /api/video/upload-complete                          │
│    Body: { videoId }                                        │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│ 5. 后端确认并处理                                            │
│    - 验证文件是否真的上传成功（调用MinIO检查）                 │
│    - 更新数据库视频状态：上传完成                             │
│    - 发送消息到 RabbitMQ（触发转码、生成封面等异步任务）       │
│    - 返回：{ success: true, videoUrl }                      │
└─────────────────────────────────────────────────────────────┘


视频上传功能实现步骤
第一步：完善数据模型
文件：models/user.go
要做的事：
给 Video 模型添加 Status 字段（视频状态）
添加状态常量定义（上传中、上传完成、已发布等）

第二步：封装 MinIO 操作函数
文件：utils/minio.go
要做的事：
GenerateUploadURL(filename) - 生成预签名上传URL
GenerateDownloadURL(filename) - 生成预签名下载URL
CheckFileExists(filename) - 检查文件是否存在

第三步：封装视频相关数据库操作
文件：utils/mysql.go
要做的事：
CreateVideo(video) - 创建视频记录
GetVideoByID(id) - 根据ID查询视频
UpdateVideoStatus(id, status) - 更新视频状态
UpdateVideoURL(id, url) - 更新视频URL

第四步：实现视频服务层
文件：services/video_service.go（新建）
要做的事：
GetUploadURL(userID, filename, filesize) - 获取上传凭证的业务逻辑
ConfirmUpload(userID, videoID) - 确认上传完成的业务逻辑
文件格式、大小验证
生成唯一文件名（UUID）

第五步：实现视频控制器
文件：controllers/video.go（新建）
要做的事：
GetUploadURL - 处理 POST /api/video/upload-url
ConfirmUpload - 处理 POST /api/video/upload-complete
请求参数绑定和响应

第六步：注册路由
文件：routes/routes.go
要做的事：
添加 /api/video/upload-url 路由（需要JWT认证）
添加 /api/video/upload-complete 路由（需要JWT认证）



